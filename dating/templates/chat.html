{% extends 'base/base.html' %}
{% block content %}
<h2 style="margin-bottom: 20px;">Chat with {{ other_user.username }}</h2>

<div style="max-height: 400px; overflow-y: auto; border: 1px solid #ccc; border-radius: 8px; padding: 15px; margin-bottom: 20px; background: #f9f9f9;">
    {% if messages %}
        {% for msg in messages %}
            <div style="margin-bottom: 15px; padding: 10px; 
                        background-color: {% if msg.sender == user %}#dcf8c6{% else %}#fff{% endif %};
                        border-radius: 10px; max-width: 70%; 
                        {% if msg.sender == user %}margin-left: auto;{% else %}margin-right: auto;{% endif %};
                        box-shadow: 0 1px 2px rgba(0,0,0,0.1);">
                <p style="margin: 0; font-weight: 600; color: #333;">{{ msg.sender.username }}</p>
                <p style="margin: 5px 0 0 0; line-height: 1.4; white-space: pre-wrap;">{{ msg.content }}</p>
                <small style="display: block; text-align: right; color: #888; margin-top: 5px;">
                    {{ msg.timestamp|date:"M d, H:i" }}
                </small>
            </div>
        {% endfor %}
    {% else %}
        <p style="color: #666; text-align: center;">No messages yet. Say hello!</p>
    {% endif %}
</div>

<form method="post" style="display: flex; gap: 10px; align-items: center;">
    {% csrf_token %}
    {{ form.content }}
    <button type="submit" style="padding: 10px 20px; background-color: #d6336c; border: none; color: white; border-radius: 5px; cursor: pointer;">
        Send
    </button>
</form>

<p style="margin-top: 20px;">
    <a href="{% url 'conversations' %}" style="color: #d6336c; text-decoration: none;">← Back to Matches</a>
</p>
{% endblock %}
