{% extends 'base.html' %} {% load static %} {% block content %}
<div class="chat-container">
  <div class="chat-sidebar">
    <h2>Conversations</h2>
    <ul>
      {% for user in users %}
      <li><a href="{% url 'chat_room' user.id %}">{{ user.username }}</a></li>
      {% endfor %}
    </ul>
  </div>
  <div class="chat-main">
    <h2>Chat with {{ receiver.username }}</h2>
    <div
      class="chat-messages"
      id="chat-messages"
      data-username="{{ user.username }}"
    >
      {% for message in messages %}
      <div
        class="message {% if message.sender == user %}sent{% else %}received{% endif %}"
      >
        <p>
          <strong>{{ message.sender.username }}</strong>: {{ message.content }}
        </p>
        <span>{{ message.timestamp|date:"Y-m-d H:i" }}</span>
      </div>
      {% endfor %}
    </div>
    <div class="chat-input">
      <input type="text" id="message-input" placeholder="Type a message..." />
      <button id="send-button">Send</button>
    </div>
  </div>
</div>
<script src="/static/assets/js/chat.js"></script>
<script>
  const receiverId = {{ receiver.id }};
  const userId = {{ user.id }};
  initializeWebSocket(receiverId, userId);
</script>
{% endblock %}
